getGlobal GAME_STATE --> gameState


if gameState < 60
    endthread
endif

if gameState == 60
    freezeInputs
    dialogBox "Li Fei Profile" "Hello... Sebastian. Nice to meet you."
    dialogBox "Li Fei Profile" "Yeah, I requested a little help from Njeri. "

    var m1 "First, I need you to retrieve a certain artifact for me. "
    var m2 "It's found in some old ruins in the forest area or something."
        eval m1 + m2 --> msg
        dialogBox "Li Fei Profile" msg

    dialogBox "Li Fei Profile" "Please find it for me. It's like a picture or so..."

    -- We are sent to find the artifact.
    writeGlobal 65 --> GAME_STATE

    unfreezeInputs
    endthread
endif


-- Looking for artifact now
if gameState == 65

    freezeInputs
    dialogBox "Li Fei Profile" "Hey, any luck finding the artifact yet?"
    unfreezeInputs
    endthread

endif


-- Once you've obtained the artifact, gameState should equal 75
if gameState == 75
    freezeInputs
    dialogBox "Li Fei Profile" "You found it?"
    dialogBox "Sebastian Profile" "... Yes... yes I did. What exactly is this for?"
    dialogBox "Li Fei Profile" "Alright, thanks! The next thing I need you to do is find Edmund's hat."
    dialogBox "Sebastian Profile" "Sure, where is it?"
    var m1 "I'm pretty sure he left it in the warehouse of Iodolm. Just go into the main administrative "
    var m2 "building and take the stairs."
        eval m1 + m2 --> msg
        dialogBox "Li Fei Profile" msg
    dialogBox "Sebastian Profile" "Alright, I'll go look for it."
    dialogBox "Li Fei Profile" "Thanks again!"
    unfreezeInputs
    endthread
endif

if gameState == 80
    freezeInputs
    var m1 "Hey, Sebastian... We started to grow real concerned after you didn't get back to us "
    var m2 "after over three hours, so we sent somebody to look for you in the warehouse. "
    var m3 "What you just experienced was crate-fatigue disorder. It's what happens when you "
    var m4 "are exposed to way too many crates in too short a time-span. Goddamn crates are everywhere. "
    var m5 "It's like you can't turn a corner without seeing a freaking crate."
    eval [ m1 + m2 ] + [ m3 + [ m4 + m5 ] ] --> msg
    dialogBox "Li Fei Profile" msg

    dialogBox "Sebastian Profile" "Wow, tell me about it. There are crates everywhere and it doesn't even make sense..."
    dialogBox "Sebastian Profile" "Oh yeah, you found Edmund's hat, right?"

    var m1 "Of course, yeah... Anyway I'm glad you're feeling better now. Just report to Njeri. " 
    var m2 "Actually, yeah, something really important came up while you were passed out. "
    var m3 "Please report to her immediately. I'm really busy so I can't explain more, but go to her NOW."
    eval m1 + [ m2 + m3 ] --> msg
    dialogBox "Li Fei Profile" msg

    newArray testOptions 2
            putArray testOptions 0 <-- "Of course!"
            putArray testOptions 1 <-- "Absolutely not!!"
    var promptquestion "So will you help me?"

    dialogPrompt "Li Fei Profile" promptquestion testOptions --> result

    if result == 0
        dialogBox "Li Fei Profile" "Fantastic!"
        dialogBox "Li Fei Profile" "Go... now!"
    endif
    if result == 1
        dialogBox "Sebastian Profile" "Seriously? I just recovered from fainting and you're giving me work to do? What is wrong with you? I think you should be the one being sent to the crate expectations room. Crates are crate!"
        dialogBox "Li Fei Profile" "Too bad. Now go!"
    endif

    unfreezeInputs

    -- 85 means report to Njeri
    writeGlobal 85 --> GAME_STATE

    endthread
endif

-- Insist in talking to Njeri now...
if gameState == 85
    freezeInputs
    dialogBox "Li Fei Profile" "Sebastian, please talk to Njeri as soon as possible."
    unfreezeInputs 
    endthread
endif


endthread