assumeControlOfPlayer
wait 20

-- goto [DEBUG]

-- Move right
setAnimationDirection 3
setVelocity 0.25 0
moveTileAmount 11.5

-- Move up into room
setAnimationDirection 0
setVelocity 0 -0.25
movePixelAmount 515

-- Pause for a moment
wait 600

-- Look around
setAnimationDirection 2
wait 400
setAnimationDirection 3
wait 400
setAnimationDirection 1
wait 400
setAnimationDirection 0
wait 400

var m1 "Ugh... the Maelloc soldiers probably intend to jack all my shit. "
var m2 "I hope that through time travel, I can prevent that from happening."

eval m1 + m2 --> msg
playerMessageBox msg

playerMessageBox "For now, I had better prepare myself with some supplies..."

-- Move left
setAnimationDirection 2
setVelocity -0.25 0.02
moveTileAmount 5
setAnimationDirection 1

playerMessageBox "It's been a while since I've actively fought, but some armor'd be nice..."

wait 300

-- Move up-right
setAnimationDirection 0
setVelocity 0.175 -0.125
moveTileAmount 3

playerMessageBox "Spellbooks... spellbooks..."

-- Move right
setAnimationDirection 3
setVelocity 0.25 0
moveTileAmount 5
setAnimationDirection 0

playerMessageBox "And there they are."

-- Move right to fit in between the place we will fly away
setAnimationDirection 3
setVelocity 0.25 0
movePixelAmount 95
setAnimationDirection 0

playerMessageBox "Alright, time to get ready. Here goes nothing..."
playerMessageBox "I AM CHANNELING MY INNER CHI"

writeGlobal 15 --> GAME_STATE

-- CREATE A LISTENER FOR THE PLAYER TO FLY 
newthread 4 "newThreadLyfe"

-- spinny spin time
var continue false
var waittime 100
while continue == false

    setAnimationDirection 0
    wait waittime
    setAnimationDirection 1
    wait waittime
    setAnimationDirection 2
    wait waittime
    setAnimationDirection 3
    wait waittime

    getGlobal GAME_STATE --> asdfasdf

    -- markers to spin faster and faster
    if asdfasdf == 20
        setvar waittime 60
    endif
    if asdfasdf == 25
        setvar waittime 30
    endif
    if asdfasdf == 35
        goto [break]
    endif
wend

label [break]

mapChange "src/res/FOREST.tmx" 1000 1700
endthread





label [DEBUG]

writeGlobal 65 --> GAME_STATE
unfreezeInputs
mapChange "src/res/FOREST.tmx" 1000 1700
endthread